"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handler = void 0;
const AWS = require("aws-sdk");
const s3 = new AWS.S3();
exports.handler = async (event = {}) => {
    const bucketName = process.env.BUCKET_NAME;
    const json_body = event.body;
    const file_name = json_body.name;
    const file_content = json_body.file;
    const fileBase64 = file_content.split(",")[1];
    // %Y-%m-%d %H:%M:%S%
    const unique_id = (new Date().toISOString().slice(0, 10));
    const full_path = `${unique_id}/${file_name}`;
    const putObjectInput = {
        Bucket: bucketName,
        Body: fileBase64,
        ContentType: 'image/jpg',
        Key: full_path
    };
    const bucketResponse = await s3.putObject(putObjectInput);
    return {
        'statusCode': 200,
        'headers': {
            'Content-Type': 'text/json',
            'Access-Control-Allow-Origin': '*',
        },
        'body': JSON.stringify({
            message: 'success',
            bucketResponse
        })
    };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW1hZ2VVcGxvYWRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImltYWdlVXBsb2FkZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsK0JBQStCO0FBSS9CLE1BQU0sRUFBRSxHQUFHLElBQUksR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFBO0FBRVYsUUFBQSxPQUFPLEdBQUcsS0FBSyxFQUFFLFFBQWEsRUFBRSxFQUFnQixFQUFFO0lBQzNELE1BQU0sVUFBVSxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBcUIsQ0FBQztJQUNyRCxNQUFNLFNBQVMsR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFBO0lBQzVCLE1BQU0sU0FBUyxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUE7SUFDaEMsTUFBTSxZQUFZLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQTtJQUVuQyxNQUFNLFVBQVUsR0FBRyxZQUFZLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBRTdDLHFCQUFxQjtJQUNyQixNQUFNLFNBQVMsR0FBRyxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsV0FBVyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFBO0lBQ3pELE1BQU0sU0FBUyxHQUFHLEdBQUcsU0FBUyxJQUFJLFNBQVMsRUFBRSxDQUFDO0lBRTlDLE1BQU0sY0FBYyxHQUFxQjtRQUNyQyxNQUFNLEVBQUUsVUFBVTtRQUNsQixJQUFJLEVBQUUsVUFBVTtRQUNoQixXQUFXLEVBQUUsV0FBVztRQUN4QixHQUFHLEVBQUUsU0FBUztLQUNqQixDQUFBO0lBRUQsTUFBTSxjQUFjLEdBQTBDLE1BQU0sRUFBRSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsQ0FBQTtJQUVoRyxPQUFPO1FBQ0gsWUFBWSxFQUFFLEdBQUc7UUFDakIsU0FBUyxFQUFFO1lBQ1AsY0FBYyxFQUFFLFdBQVc7WUFDM0IsNkJBQTZCLEVBQUUsR0FBRztTQUNyQztRQUNELE1BQU0sRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDO1lBQ25CLE9BQU8sRUFBRSxTQUFTO1lBQ2xCLGNBQWM7U0FDakIsQ0FBQztLQUNMLENBQUE7QUFDTCxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBBV1MgZnJvbSAnYXdzLXNkayc7XG5pbXBvcnQge0FXU0Vycm9yLCBSZXF1ZXN0LCBTM30gZnJvbSAnYXdzLXNkayc7XG5pbXBvcnQge1B1dE9iamVjdFJlcXVlc3R9IGZyb20gJ2F3cy1zZGsvY2xpZW50cy9zMyc7XG5cbmNvbnN0IHMzID0gbmV3IEFXUy5TMygpXG5cbmV4cG9ydCBjb25zdCBoYW5kbGVyID0gYXN5bmMgKGV2ZW50OiBhbnkgPSB7fSk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgY29uc3QgYnVja2V0TmFtZSA9IHByb2Nlc3MuZW52LkJVQ0tFVF9OQU1FIGFzIHN0cmluZztcbiAgICBjb25zdCBqc29uX2JvZHkgPSBldmVudC5ib2R5XG4gICAgY29uc3QgZmlsZV9uYW1lID0ganNvbl9ib2R5Lm5hbWVcbiAgICBjb25zdCBmaWxlX2NvbnRlbnQgPSBqc29uX2JvZHkuZmlsZVxuXG4gICAgY29uc3QgZmlsZUJhc2U2NCA9IGZpbGVfY29udGVudC5zcGxpdChcIixcIilbMV1cblxuICAgIC8vICVZLSVtLSVkICVIOiVNOiVTJVxuICAgIGNvbnN0IHVuaXF1ZV9pZCA9IChuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTApKVxuICAgIGNvbnN0IGZ1bGxfcGF0aCA9IGAke3VuaXF1ZV9pZH0vJHtmaWxlX25hbWV9YDtcblxuICAgIGNvbnN0IHB1dE9iamVjdElucHV0OiBQdXRPYmplY3RSZXF1ZXN0ID0ge1xuICAgICAgICBCdWNrZXQ6IGJ1Y2tldE5hbWUsXG4gICAgICAgIEJvZHk6IGZpbGVCYXNlNjQsXG4gICAgICAgIENvbnRlbnRUeXBlOiAnaW1hZ2UvanBnJyxcbiAgICAgICAgS2V5OiBmdWxsX3BhdGhcbiAgICB9XG5cbiAgICBjb25zdCBidWNrZXRSZXNwb25zZTogUmVxdWVzdDxTMy5QdXRPYmplY3RPdXRwdXQsIEFXU0Vycm9yPiA9IGF3YWl0IHMzLnB1dE9iamVjdChwdXRPYmplY3RJbnB1dClcblxuICAgIHJldHVybiB7XG4gICAgICAgICdzdGF0dXNDb2RlJzogMjAwLFxuICAgICAgICAnaGVhZGVycyc6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC9qc29uJyxcbiAgICAgICAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nOiAnKicsXG4gICAgICAgIH0sXG4gICAgICAgICdib2R5JzogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgbWVzc2FnZTogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgYnVja2V0UmVzcG9uc2VcbiAgICAgICAgfSlcbiAgICB9XG59XG4iXX0=